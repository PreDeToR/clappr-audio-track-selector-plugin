!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],t):"object"==typeof exports?exports.AudioTrackSelector=t(require("Clappr")):e.AudioTrackSelector=t(e.Clappr)}(this,function(e){return function(e){function t(i){if(r[i])return r[i].exports;var o=r[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="<%=baseUrl%>/",t(0)}([/*!******************!*\
  !*** ./index.js ***!
  \******************/
function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=r(/*! ./src/main.js */1),e.exports=t.default},/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=function(e,t,r){for(var i=!0;i;){var o=e,a=t,n=r;i=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,a);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(n)}var c=Object.getPrototypeOf(o);if(null===c)return;e=c,t=a,r=n,i=!0,l=c=void 0}},s=r(/*! Clappr */2),c=r(/*! ./public/audio-track-selector.html */3),u=i(c),d=r(/*! ./public/style.scss */4),h=i(d),v=-1,f=function(e){function t(){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return a(t,e),n(t,[{key:"bindEvents",value:function(){this.listenTo(this.core,s.Events.CORE_READY,this.bindPlaybackEvents),this.listenTo(this.core.mediaControl,s.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,s.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,s.Events.MEDIACONTROL_HIDE,this.hideSelectLevelMenu)}},{key:"unBindEvents",value:function(){this.stopListening(this.core,s.Events.CORE_READY),this.stopListening(this.core.mediaControl,s.Events.MEDIACONTROL_CONTAINERCHANGED),this.stopListening(this.core.mediaControl,s.Events.MEDIACONTROL_RENDERED),this.stopListening(this.core.mediaControl,s.Events.MEDIACONTROL_HIDE),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_LEVELS_AVAILABLE),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_LEVEL_SWITCH_START),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_LEVEL_SWITCH_END),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_BITRATE)}},{key:"bindPlaybackEvents",value:function(){var e=this.core.getCurrentPlayback();this.listenTo(e,s.Events.PLAYBACK_LEVELS_AVAILABLE,this.fillLevels),this.listenTo(e,s.Events.PLAYBACK_BITRATE,this.updateCurrentLevelVideo);var t=e.levels&&e.levels.length>0;t&&this.fillLevels(e.levels)}},{key:"reload",value:function(){this.unBindEvents(),this.bindEvents(),this.bindPlaybackEvents()}},{key:"shouldRender",value:function(){if(!this.core.getCurrentContainer())return!1;var e=this.core.getCurrentPlayback();if(!e)return!1;var t=void 0!==e.currentLevel,r=!!(this.audiotrack&&this.audiotrack.length>1);return t&&r}},{key:"render",value:function(){if(this.shouldRender()){var e=s.Styler.getStyleFor(h.default,{baseUrl:this.core.options.baseUrl});this.$el.html(this.template({levels:this.audiotrack,title:this.getTitle()})),this.$el.append(e),this.core.mediaControl.$(".media-control-right-panel").append(this.el),this.highlightCurrentLevel()}return this}},{key:"fillLevels",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?v:arguments[1];if(void 0!==this.core.getCurrentPlayback()._hls.audioTracks&&0!=this.core.getCurrentPlayback()._hls.audioTracks.length){void 0===this.selectedLevelId&&(this.selectedLevelId=t),this.audiotrack=this.core.getCurrentPlayback()._hls.audioTracks;for(var r=0;r<this.audiotrack.length;r++)this.audiotrack[r].id=r;for(var r=0;r<this.audiotrack.length;r++)this.audiotrack[r].groupId==this.core.getCurrentPlayback()._hls.streamController.levels[+this.core.getCurrentPlayback()._hls.streamController.level].attrs.AUDIO&&1==this.audiotrack[r].default&&(this.selectedLevelId=r,this.currentLevel=this.audiotrack[this.selectedLevelId],this.core.getCurrentPlayback()._hls.audioTrack=this.selectedLevelId,this.highlightCurrentLevel());this.configureLevelsLabels(),this.render();var i=this.core.getCurrentPlayback()._hls.streamController.levels[this.core.getCurrentPlayback()._hls.streamController.level].attrs.AUDIO;this.agroupElement().addClass("hidden"),this.$('.audio_track_selector ul a[data-level-group-selector-select="'+i+'"]').parent().removeClass("hidden")}}},{key:"configureLevelsLabels",value:function(){if(void 0!==this.core.options.AudioTrackSelectorConfig)for(var e in this.core.options.AudioTrackSelectorConfig.labels||{}){e=parseInt(e,10);var t=!!this.findLevelBy(e);t&&this.changeLevelLabelBy(e,this.core.options.AudioTrackSelectorConfig.labels[e])}}},{key:"findLevelBy",value:function(e){var t;return this.audiotrack.forEach(function(r){r.id===e&&(t=r)}),t}},{key:"changeLevelLabelBy",value:function(e,t){var r=this;this.audiotrack.forEach(function(i,o){i.id===e&&(r.audiotrack[o].name=t)})}},{key:"onLevelSelect",value:function(e){return this.selectedLevelId=e.target.dataset.audioTrackSelectorSelect.substr(6),this.currentLevel.id!=this.selectedLevelId&&(this.currentLevel=this.audiotrack[this.selectedLevelId],this.core.getCurrentPlayback()._hls.audioTrack=this.selectedLevelId,this.toggleContextMenu(),this.highlightCurrentLevel(),e.stopPropagation(),!1)}},{key:"onShowLevelSelectMenu",value:function(e){this.toggleContextMenu()}},{key:"hideSelectLevelMenu",value:function(){this.$(".audio_track_selector ul").hide()}},{key:"toggleContextMenu",value:function(){this.$(".audio_track_selector ul").toggle()}},{key:"buttonElement",value:function(){return this.$(".audio_track_selector button")}},{key:"levelElement",value:function(e){return this.$(".audio_track_selector ul a"+(isNaN(e)?"":'[data-audio-track-selector-select="audio_'+e+'"]')).parent()}},{key:"agroupElement",value:function(e){return this.$(".audio_track_selector ul a"+(isNaN(e)?"":'[data-level-group-selector-select="'+e+'"]')).parent()}},{key:"getTitle",value:function(){return(this.core.options.AudioTrackSelectorConfig||{}).name}},{key:"startLevelSwitch",value:function(){this.buttonElement().addClass("changing")}},{key:"stopLevelSwitch",value:function(){this.buttonElement().removeClass("changing")}},{key:"updateText",value:function(e){e===-1?(this.buttonElement().text(this.findLevelBy(this.audiotrack[0].id).name),this.selectedLevelId=this.audiotrack[0].id):this.buttonElement().text(this.findLevelBy(this.audiotrack[e].id).name)}},{key:"updateCurrentLevel",value:function(e){var t=this.findLevelBy(e.id);this.currentLevel=t?t:null,this.highlightCurrentLevel()}},{key:"updateCurrentLevelVideo",value:function(e){if(void 0!=this.audiotrack&&0!=this.audiotrack.length){var t=this.core.getCurrentPlayback()._hls.streamController.levels[e.level].attrs.AUDIO;this.agroupElement().addClass("hidden"),this.$('.audio_track_selector ul a[data-level-group-selector-select="'+t+'"]').parent().removeClass("hidden");for(var r=0;r<this.audiotrack.length;r++)if(this.audiotrack[r].groupId==this.core.getCurrentPlayback()._hls.streamController.levels[e.level].attrs.AUDIO&&1==this.audiotrack[r].default){if(this.selectedLevelId=r,this.currentLevel.id==this.selectedLevelId)return!1;this.currentLevel=this.audiotrack[this.selectedLevelId],this.core.getCurrentPlayback()._hls.audioTrack=this.selectedLevelId,this.highlightCurrentLevel()}}}},{key:"highlightCurrentLevel",value:function(){this.levelElement().removeClass("current"),this.levelElement(this.currentLevel.id).addClass("current"),this.updateText(this.selectedLevelId)}},{key:"name",get:function(){return"audio_track_selector"}},{key:"template",get:function(){return(0,s.template)(u.default)}},{key:"attributes",get:function(){return{class:this.name,"data-audio-track-selector":""}}},{key:"events",get:function(){return{"click [data-audio-track-selector-select]":"onLevelSelect","click [data-audio-track-selector-button]":"onShowLevelSelectMenu"}}}],[{key:"version",get:function(){return VERSION}}]),t}(s.UICorePlugin);t.default=f,e.exports=t.default},/*!*************************!*\
  !*** external "Clappr" ***!
  \*************************/
function(t,r){t.exports=e},/*!**********************************************!*\
  !*** ./src/public/audio-track-selector.html ***!
  \**********************************************/
function(e,t){e.exports='<button data-audio-track-selector-button>\n  Auto\n</button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <% for (var i = 0; i < levels.length; i++) { %>\n    <li><a href="#" data-audio-track-selector-select="audio_<%= i %>" data-level-group-selector-select="<%= levels[i].groupId %>"><%= levels[i].name %></a></li>\n  <% }; %>\n</ul>\n'},/*!*******************************!*\
  !*** ./src/public/style.scss ***!
  \*******************************/
function(e,t,r){t=e.exports=r(/*! ../../~/css-loader/lib/css-base.js */5)(),t.push([e.id,".audio_track_selector[data-audio-track-selector]{float:right;margin-top:5px;position:relative}.audio_track_selector[data-audio-track-selector] button{background-color:transparent;color:#fff;font-family:Roboto,Open Sans,Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:10px}.audio_track_selector[data-audio-track-selector] button:hover{color:#c9c9c9}.audio_track_selector[data-audio-track-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.audio_track_selector[data-audio-track-selector]>ul{list-style-type:none;position:absolute;bottom:25px;border:1px solid #000;display:none;background-color:#e6e6e6;white-space:nowrap}.audio_track_selector[data-audio-track-selector] li{font-size:10px}.audio_track_selector[data-audio-track-selector] li[data-title]{background-color:#c3c2c2;padding:5px}.audio_track_selector[data-audio-track-selector] li a{color:#444;padding:2px 10px;display:block;text-decoration:none}.audio_track_selector[data-audio-track-selector] li a:hover{background-color:#555;color:#fff}.audio_track_selector[data-audio-track-selector] li a:hover a{color:#fff;text-decoration:none}.audio_track_selector[data-audio-track-selector] li.current a{color:red}.hidden{display:none}@-webkit-keyframes pulse{0%{color:#fff}50%{color:#ff0101}to{color:#b80000}}",""])},/*!**************************************!*\
  !*** ./~/css-loader/lib/css-base.js ***!
  \**************************************/
function(e,t){"use strict";e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var r=this[t];r[2]?e.push("@media "+r[2]+"{"+r[1]+"}"):e.push(r[1])}return e.join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(i[a]=!0)}for(o=0;o<t.length;o++){var n=t[o];"number"==typeof n[0]&&i[n[0]]||(r&&!n[2]?n[2]=r:r&&(n[2]="("+n[2]+") and ("+r+")"),e.push(n))}},e}}])});
//# sourceMappingURL=audio-track-selector.min.js.map