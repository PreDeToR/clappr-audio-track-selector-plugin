!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],t):"object"==typeof exports?exports.AudioTrackSelector=t(require("Clappr")):e.AudioTrackSelector=t(e.Clappr)}(this,function(e){return function(e){function t(i){if(o[i])return o[i].exports;var r=o[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var o={};return t.m=e,t.c=o,t.p="<%=baseUrl%>/",t(0)}([/*!******************!*\
  !*** ./index.js ***!
  \******************/
function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=o(/*! ./src/main.js */1),e.exports=t.default},/*!*********************!*\
  !*** ./src/main.js ***!
  \*********************/
function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),l=function(e,t,o){for(var i=!0;i;){var r=e,n=t,a=o;i=!1,null===r&&(r=Function.prototype);var l=Object.getOwnPropertyDescriptor(r,n);if(void 0!==l){if("value"in l)return l.value;var s=l.get;if(void 0===s)return;return s.call(a)}var c=Object.getPrototypeOf(r);if(null===c)return;e=c,t=n,o=a,i=!0,l=c=void 0}},s=o(/*! Clappr */2),c=o(/*! ./public/audio-track-selector.html */3),u=i(c),d=o(/*! ./public/style.scss */4),h=i(d),f=-1,v=function(e){function t(){r(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).apply(this,arguments)}return n(t,e),a(t,[{key:"bindEvents",value:function(){this.listenTo(this.core,s.Events.CORE_READY,this.bindPlaybackEvents),this.listenTo(this.core.mediaControl,s.Events.MEDIACONTROL_CONTAINERCHANGED,this.reload),this.listenTo(this.core.mediaControl,s.Events.MEDIACONTROL_RENDERED,this.render),this.listenTo(this.core.mediaControl,s.Events.MEDIACONTROL_HIDE,this.hideSelectLevelMenu)}},{key:"unBindEvents",value:function(){this.stopListening(this.core,s.Events.CORE_READY),this.stopListening(this.core.mediaControl,s.Events.MEDIACONTROL_CONTAINERCHANGED),this.stopListening(this.core.mediaControl,s.Events.MEDIACONTROL_RENDERED),this.stopListening(this.core.mediaControl,s.Events.MEDIACONTROL_HIDE),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_LEVELS_AVAILABLE),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_LEVEL_SWITCH_START),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_LEVEL_SWITCH_END),this.stopListening(this.core.getCurrentPlayback(),s.Events.PLAYBACK_BITRATE)}},{key:"bindPlaybackEvents",value:function(){var e=this.core.getCurrentPlayback();this.listenTo(e,s.Events.PLAYBACK_LEVELS_AVAILABLE,this.fillLevels);var t=e.levels&&e.levels.length>0;t&&this.fillLevels(e.levels)}},{key:"reload",value:function(){this.unBindEvents(),this.bindEvents(),this.bindPlaybackEvents()}},{key:"shouldRender",value:function(){if(!this.core.getCurrentContainer())return!1;var e=this.core.getCurrentPlayback();if(!e)return!1;var t=void 0!==e.currentLevel,o=!!(this.audiotrack&&this.audiotrack.length>1);return t&&o}},{key:"render",value:function(){if(this.shouldRender()){var e=s.Styler.getStyleFor(h.default,{baseUrl:this.core.options.baseUrl});this.$el.html(this.template({levels:this.audiotrack,title:this.getTitle()})),this.$el.append(e),this.core.mediaControl.$(".media-control-right-panel").append(this.el),this.highlightCurrentLevel()}return this}},{key:"fillLevels",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?f:arguments[1];if(void 0!==this.core.getCurrentPlayback()._hls.audioTracks&&0!=this.core.getCurrentPlayback()._hls.audioTracks.length){void 0===this.selectedLevelId&&(this.selectedLevelId=t),this.audiotrack=this.core.getCurrentPlayback()._hls.audioTracks;for(var o=0;o<this.audiotrack.length;o++)this.audiotrack[o].id=o,1==this.audiotrack[o].default&&(this.updateCurrentLevel(this.audiotrack[o]),this.selectedLevelId=o,this.currentLevel=this.audiotrack[o]);this.configureLevelsLabels(),this.render()}}},{key:"configureLevelsLabels",value:function(){if(void 0!==this.core.options.AudioTrackSelectorConfig)for(var e in this.core.options.AudioTrackSelectorConfig.labels||{}){e=parseInt(e,10);var t=!!this.findLevelBy(e);t&&this.changeLevelLabelBy(e,this.core.options.AudioTrackSelectorConfig.labels[e])}}},{key:"findLevelBy",value:function(e){var t;return this.audiotrack.forEach(function(o){o.id===e&&(t=o)}),t}},{key:"changeLevelLabelBy",value:function(e,t){var o=this;this.audiotrack.forEach(function(i,r){i.id===e&&(o.audiotrack[r].name=t)})}},{key:"onLevelSelect",value:function(e){return this.selectedLevelId=e.target.dataset.audioTrackSelectorSelect.substr(6),this.currentLevel.id!=this.selectedLevelId&&(this.currentLevel=this.audiotrack[this.selectedLevelId],this.core.getCurrentPlayback()._hls.audioTrack=this.selectedLevelId,this.toggleContextMenu(),this.highlightCurrentLevel(),e.stopPropagation(),!1)}},{key:"onShowLevelSelectMenu",value:function(e){this.toggleContextMenu()}},{key:"hideSelectLevelMenu",value:function(){this.$(".audio_track_selector ul").hide()}},{key:"toggleContextMenu",value:function(){this.$(".audio_track_selector ul").toggle()}},{key:"buttonElement",value:function(){return this.$(".audio_track_selector button")}},{key:"levelElement",value:function(e){return this.$(".audio_track_selector ul a"+(isNaN(e)?"":'[data-audio-track-selector-select="audio_'+e+'"]')).parent()}},{key:"getTitle",value:function(){return(this.core.options.AudioTrackSelectorConfig||{}).name}},{key:"startLevelSwitch",value:function(){this.buttonElement().addClass("changing")}},{key:"stopLevelSwitch",value:function(){this.buttonElement().removeClass("changing")}},{key:"updateText",value:function(e){e===-1?(this.buttonElement().text(this.findLevelBy(this.audiotrack[0].id).name),this.selectedLevelId=this.audiotrack[0].id):this.buttonElement().text(this.findLevelBy(this.audiotrack[e].id).name)}},{key:"updateCurrentLevel",value:function(e){var t=this.findLevelBy(e.id);this.currentLevel=t?t:null,this.highlightCurrentLevel()}},{key:"highlightCurrentLevel",value:function(){this.levelElement().removeClass("current"),this.levelElement(this.currentLevel.id).addClass("current"),this.updateText(this.selectedLevelId)}},{key:"name",get:function(){return"audio_track_selector"}},{key:"template",get:function(){return(0,s.template)(u.default)}},{key:"attributes",get:function(){return{class:this.name,"data-audio-track-selector":""}}},{key:"events",get:function(){return{"click [data-audio-track-selector-select]":"onLevelSelect","click [data-audio-track-selector-button]":"onShowLevelSelectMenu"}}}],[{key:"version",get:function(){return VERSION}}]),t}(s.UICorePlugin);t.default=v,e.exports=t.default},/*!*************************!*\
  !*** external "Clappr" ***!
  \*************************/
function(t,o){t.exports=e},/*!**********************************************!*\
  !*** ./src/public/audio-track-selector.html ***!
  \**********************************************/
function(e,t){e.exports='<button data-audio-track-selector-button>\n  Auto\n</button>\n<ul>\n  <% if (title) { %>\n  <li data-title><%= title %></li>\n  <% }; %>\n  <% for (var i = 0; i < levels.length; i++) { %>\n    <li><a href="#" data-audio-track-selector-select="audio_<%= i %>"><%= levels[i].name %></a></li>\n  <% }; %>\n</ul>\n'},/*!*******************************!*\
  !*** ./src/public/style.scss ***!
  \*******************************/
function(e,t,o){t=e.exports=o(/*! ../../~/css-loader/lib/css-base.js */5)(),t.push([e.id,".audio_track_selector[data-audio-track-selector]{float:right;margin-top:5px;position:relative}.audio_track_selector[data-audio-track-selector] button{background-color:transparent;color:#fff;font-family:Roboto,Open Sans,Arial,sans-serif;-webkit-font-smoothing:antialiased;border:none;font-size:10px}.audio_track_selector[data-audio-track-selector] button:hover{color:#c9c9c9}.audio_track_selector[data-audio-track-selector] button.changing{-webkit-animation:pulse .5s infinite alternate}.audio_track_selector[data-audio-track-selector]>ul{list-style-type:none;position:absolute;bottom:25px;border:1px solid #000;display:none;background-color:#e6e6e6;white-space:nowrap}.audio_track_selector[data-audio-track-selector] li{font-size:10px}.audio_track_selector[data-audio-track-selector] li[data-title]{background-color:#c3c2c2;padding:5px}.audio_track_selector[data-audio-track-selector] li a{color:#444;padding:2px 10px;display:block;text-decoration:none}.audio_track_selector[data-audio-track-selector] li a:hover{background-color:#555;color:#fff}.audio_track_selector[data-audio-track-selector] li a:hover a{color:#fff;text-decoration:none}.audio_track_selector[data-audio-track-selector] li.current a{color:red}@-webkit-keyframes pulse{0%{color:#fff}50%{color:#ff0101}to{color:#b80000}}",""])},/*!**************************************!*\
  !*** ./~/css-loader/lib/css-base.js ***!
  \**************************************/
function(e,t){"use strict";e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var o=this[t];o[2]?e.push("@media "+o[2]+"{"+o[1]+"}"):e.push(o[1])}return e.join("")},e.i=function(t,o){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var n=this[r][0];"number"==typeof n&&(i[n]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(o&&!a[2]?a[2]=o:o&&(a[2]="("+a[2]+") and ("+o+")"),e.push(a))}},e}}])});
//# sourceMappingURL=audio-track-selector.min.js.map